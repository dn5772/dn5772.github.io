---
title: '7-shell-code'
description: assembly
date: 2024-05-17
tags: 
    - shell
    - summay
categories:
    - summary/cesc
---

## 7-쉘 코드

1. “/bin/sh” 문자열을 임의의 메모리에 위치시킨다.
2. NULL문자(=0) 1 바이트를 “/bin/sh”뒤에 붙여준다. 즉, “/bin/sh\0”이 되도록 한다.
3. /bin/sh 문자열 주소값을 불러와서 name[0]에 할당한다. 즉, name[]={“sh”,0} 와 name[]={“/bin/sh”,0}는 동일하기 때문에 sh 문자열을 별도로 추가할 필요는 없다.
4. 0 (=null)값을 name[1]에 해당하는 주소에 할당한다.
5. 0xb(11)를 EAX 레지스터에 저장한다.
6. /bin/sh 문자열의 주소를 EBX 레지스터에 저장한다. 
7. name 배열의 주소를 ECX 레지스터에 저장한다.
8. 0x0을 EDX 레지스터에 저장한다.
9. int $0x80 명령을 실행한다.
10. 0x1 (exit 시스템콜 번호)을 EAX 레지스터에 저장한다. 
11. 0x0을 EBX 레지스터에 복사한다.
12. int $0x80 명령을 실행한다.

이런식으로 쉘이 실행 됨

### 스택, 데이터영역 사용 안하고 code(text)영역만 사용해서 쉘 실행

1-12번 까지의 과정에서 "/bin/sh" 문자열의 시작 주소만 알면 text만으로 실행하도록 text를 추출할 수 있음


1번 방법 
---
레이블(.LC0)을 설정해서 문자열의 시작주소를 추출

=> 이 방법으로 추출한 shell code는 .LC0의 주소값이 하드코딩 되어버림
- 실제 "/bin/sh" 문자열 주소와는 다른 주소로 접근해서 실패

2번 방법
---
트렘펄링 방법으로 실행시에 "/bin/sh" 시작주소를 확보




